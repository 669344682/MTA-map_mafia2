local object = {
{'SO_teren_OM_01', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-672.984375, -268.754089355469, -6.81017971038818, 0} }, 0},
{'SO_teren_OM_02', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0.651997029781342, -399.602020263672, -17.2155609130859, 0} }, 0},
{'SO_teren_OM_03', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {81.9436874389648, -467.812408447266, -20.9010906219482, 0} }, 0},
{'SO_teren_OM_04', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-7.68727254867554, -486.649139404297, -16.9280490875244, 0} }, 0},
{'SO_teren_OM_05', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {9.75885486602783, -449.403381347656, -20.5347328186035, 0} }, 0},
{'SO_teren_OM_06', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-48.8910827636719, -659.266967773438, -21.1699676513672, 0} }, 0},
{'SO_teren_OM_07', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-220.837463378906, -529.480834960938, -17.6585636138916, 0} }, 0},
{'SO_teren_OM_08', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-230.378341674805, -420.804626464844, -17.1400527954102, 0} }, 0},
{'SO_teren_OM_09', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-253.982940673828, -393.330535888672, -16.5690822601318, 0} }, 0},
{'SO_teren_OM_12', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-236.114776611328, -642.9736328125, -20.781436920166, 0} }, 0},
{'SO_teren_OM_11', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-215.123596191406, -464.668121337891, -15.5555515289307, 0} }, 0},
{'SO_teren_OM_10', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-118.551422119141, -540.557556152344, -19.5574436187744, 0} }, 0},
{'SO_teren_OM_16', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-498.872894287109, -526.546997070313, -19.1573791503906, 0} }, 0},
{'SO_teren_OM_15', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-424.892181396484, -472.463897705078, -18.0502910614014, 0} }, 0},
{'SO_teren_OM_14', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-402.09375, -535.199157714844, -19.0774536132813, 0} }, 0},
{'SO_teren_OM_19', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-587.432312011719, -400.324676513672, -15.9927587509155, 0} }, 0},
{'SO_teren_OM_18', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-458.261199951172, -393.9501953125, -15.0475959777832, 0} }, 0},
{'SO_teren_OM_26', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {72.0565872192383, -565.059326171875, -20.2420501708984, 0} }, 0},
{'SO_teren_OM_27', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-38.275032043457, -518.094848632813, -17.9795532226563, 0} }, 0},
{'SO_teren_OM_24', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-856.144775390625, -509.926330566406, -23.2448425292969, 0} }, 0},
{'SO_teren_OM_25', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-779.736145019531, -515.317565917969, -25.4026565551758, 0} }, 0},
{'SO_teren_OM_22', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-835.689880371094, -403.934295654297, -25.184684753418, 0} }, 0},
{'SO_teren_OM_23', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-954.4130859375, -427.260528564453, -22.4005374908447, 0} }, 0},
{'SO_teren_OM_20', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-575.822326660156, -549.835083007813, -22.100606918335, 0} }, 0},
{'SO_teren_OM_29', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-219.85417175293, -570.931762695313, -18.6945819854736, 0} }, 0},
{'SO_teren_OM_31', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-653.563842773438, -452.184753417969, -20.399845123291, 0} }, 0},
{'SO_teren_OM_30', { {1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {-652.159606933594, -534.339904785156, -25.2614517211914, 0} }, 0},

}
print(os.date())
function string.split(input, separator)

	if type(input) ~= "string" then error("type mismatch in argument #1", 3) end
	if (separator and type(separator) ~= "string") then error("type mismatch in argument #2", 3) end

	if not separator then
		separator = "%s"
	end
	local t = {}
	local i = 1
	for str in string.gmatch(input, "([^"..separator.."]+)") do
		t[i] = str
		i = i + 1
	end
	return t
end

local pyt_new = "C:\\test\\default_new.txt"
--[[local pyt = "C:\\default.txt"
local file = io.open(pyt, "r")
local file_new = io.open(pyt_new, "w")
local text = ""

for line in io.lines(pyt) do
	if string.find(line, "Material") then
		file_new:write(text.."\n")
		text = string.split(line, " ")[2]
	end

	if string.find(line, "File") then
		text = text.." "..tostring(string.split(line, " ")[2])
	end
end]]

for k,v in pairs(object) do
	local pyt = "C:\\"..v[1].."(0).obj.mtl"
	local file = io.open(pyt, "r")
	local text = {}

	for line in io.lines(pyt) do
		table.insert(text, line)
	end

	for k,line in ipairs(text) do
		for p in io.lines(pyt_new) do
			local spl = string.split(tostring(p), " ")
			if line == "map_kd "..tostring(spl[1])..".dds" then
				text[k] = "map_kd "..tostring(spl[2])
				break
			end
		end
	end

	file:close()

	local file = io.open(pyt, "w")
	for i,v in ipairs(text) do
		file:write(v.."\n")
	end

	file:close()
end

local file_meta = io.open("C:\\test\\meta.txt", "w")
for k,v in pairs(object) do
	local pyt = "C:\\"..v[1].."(0).obj"
	local file = io.open(pyt, "r")
	local text = {}

	for line in io.lines(pyt) do
		table.insert(text, line)
	end

	for k,line in ipairs(text) do
		if line == "g mesh" then
			text[k] = "g "..v[1]
		end
	end

	file:close()

	local file = io.open(pyt, "w")
	for i,v in ipairs(text) do
		file:write(v.."\n")
	end

	file:close()

	file_meta:write("<file src='southport/"..v[1]..".dff'/>\n")
	file_meta:write("<file src='southport/"..v[1]..".col'/>\n")
end

file_meta:close()
print(os.date())
